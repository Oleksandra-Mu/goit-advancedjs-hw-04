{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nexport const searchPhotos = async (q, page) => {\n  axios.defaults.baseURL = 'https://pixabay.com';\n  const params = {\n    key: '48208038-3c3ecca5e2ade6beba42f0ed3',\n    q: `${q}`,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: '15',\n    page: page,\n  };\n  const response = await axios.get(`/api/`, { params });\n  return response.data;\n};\n","function markup(photos) {\n  return photos.hits\n    .map(\n      element =>\n        `\n        <li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${element.largeImageURL}\" > \n              <img class=\"gallery-image\" src=\"${element.webformatURL}\" alt=\"${element.tags}\"/> \n            </a>\n            <ul class=\"statistics\">\n                <li class=\"photo-stat\">\n                <p><b>Likes</b></p>\n                <p>${element.likes}</p>\n                </li>\n                <li class=\"photo-stat\">\n                <p><b>Views</b></p> \n                <p>${element.views}</p>\n                </li>\n                <li class=\"photo-stat\">\n                <p><b>Comments</b></p> \n                <p>${element.comments}</p>\n                </li>\n                <li class=\"photo-stat\">\n                <p><b>Downloads</b></p> \n                <p>${element.downloads}</p>\n                </li>\n            </ul>\n            </li>`\n    )\n    .join('');\n}\n\nexport { markup };\n","import { searchPhotos } from './js/pixabay-api.js';\nimport { markup } from './js/render-functions.js';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst searchForm = document.querySelector('.form');\nconst loaderEl = document.querySelector('.loader');\nconst searchResults = document.querySelector('.search-result');\nconst loadMoreBtn = document.querySelector('.js-load-more');\n\nsearchForm.addEventListener('submit', initiateSearch);\n\nlet page = 1;\nlet q = '';\nlet lightbox;\nlet totalPages;\n\nfunction initiateSearch(event) {\n  event.preventDefault();\n  q = event.currentTarget.q.value.trim();\n  page = 1;\n  loaderEl.classList.remove('loader-off');\n\n  searchPhotos(q, page)\n    .then(photos => {\n      searchResults.innerHTML = '';\n      loadMoreBtn.classList.add('is-hidden');\n      if (photos.hits.length === 0) {\n        iziToast.show({\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          color: 'red',\n          position: 'topCenter',\n        });\n        loaderEl.classList.add('loader-off');\n        return;\n      }\n      const photosMarkup = markup(photos);\n\n      searchResults.insertAdjacentHTML('beforeend', photosMarkup);\n\n      totalPages = Math.ceil(photos.totalHits / 15);\n\n      if (totalPages > 1) {\n        loadMoreBtn.classList.remove('is-hidden');\n        loadMoreBtn.addEventListener('click', onLoadMoreBtnClick);\n        loaderEl.classList.add('loader-off');\n      }\n\n      lightbox = new SimpleLightbox('.search-result a', {\n        captionsData: 'alt',\n        captionDelay: 250,\n      });\n\n      lightbox.refresh();\n      loaderEl.classList.add('loader-off');\n    })\n    .catch(e => {\n      console.error(e);\n      iziToast.show({\n        message: `Error occured: ${e}`,\n        position: 'topRight',\n      });\n    })\n    .finally(() => searchForm.reset());\n}\n\nconst onLoadMoreBtnClick = async event => {\n  try {\n    loaderEl.classList.remove('loader-off');\n    page++;\n\n    const data = await searchPhotos(q, page);\n\n    const photosMarkup = markup(data);\n    searchResults.insertAdjacentHTML('beforeend', photosMarkup);\n    lightbox.refresh();\n\n    if (page === totalPages) {\n      loadMoreBtn.classList.add('is-hidden');\n      loadMoreBtn.removeEventListener('click', onLoadMoreBtnClick);\n      setTimeout(() => {\n        iziToast.show({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'bottomCenter',\n          color: 'blue',\n        });\n      }, 300);\n    }\n    smoothScroll();\n  } catch (err) {\n    console.log(err);\n  } finally {\n    loaderEl.classList.add('loader-off');\n  }\n};\n\nfunction smoothScroll() {\n  const galleryItem = document.querySelector('.gallery-item');\n  const height = galleryItem.getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["searchPhotos","q","page","axios","params","markup","photos","element","searchForm","loaderEl","searchResults","loadMoreBtn","initiateSearch","lightbox","totalPages","event","iziToast","photosMarkup","onLoadMoreBtnClick","SimpleLightbox","data","smoothScroll","err","height"],"mappings":"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"}